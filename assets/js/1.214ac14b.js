(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{50:function(t,s,n){t.exports=n.p+"assets/img/socket.bcdbb3a3.png"},52:function(t,s,n){"use strict";n.r(s);var a=[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"python-socket"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#python-socket","aria-hidden":"true"}},[t._v("#")]),t._v(" Python Socket")]),a("h2",{attrs:{id:"python-基于socket实现简单聊天程序示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#python-基于socket实现简单聊天程序示例","aria-hidden":"true"}},[t._v("#")]),t._v(" Python 基于Socket实现简单聊天程序示例")]),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),a("p",[t._v("一、面向连接的套接字Socket通信工作流程")])]),a("p",[t._v("为了实现服务器与客户机的通信,服务器和客户机都必须建立套接字。服务器与客户机的工作原理可以用下面的过程来描述。\n1.服务器先用 socket 函数来建立一个套接字,用这个套接字完成通信的监听。\n2.用 bind 函数来绑定一个端口号和 IP 地址。因为本地计算机可能有多个网址和 IP,每一个 IP 和端口有多个端口。需要指定一个 IP 和端口进行监听。\n3.服务器调用 listen 函数,使服务器的这个端口和 IP 处于监听状态,等待客户机的连接。\n4.客户机用 socket 函数建立一个套接字,设定远程 IP 和端口。\n5.客户机调用 connect 函数连接远程计算机指定的端口。\n6.服务器用 accept 函数来接受远程计算机的连接,建立起与客户机之间的通信。\n7.建立连接以后,客户机用 write 函数向 socket 中写入数据。也可以用 read 函数读取服务器发送来的数据。\n8.服务器用 read 函数读取客户机发送来的数据,也可以用 write 函数来发送数据。\n9.完成通信以后,用 close 函数关闭 socket 连接。")]),a("p",[a("img",{attrs:{src:n(50),alt:"面向链接的套接字通信工作流程"}})]),a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("该图片来自网络")])]),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("Server.py")])]),a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# 文件名：server.py")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 导入 socket 模块")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" socket\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 创建 socket 对象")]),t._v("\ns "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" socket"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("socket"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("socket"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AF_INET"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" socket"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SOCK_STREAM"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 获取本地主机名")]),t._v("\nhost "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" socket"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gethostname"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nport "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("9999")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 绑定端口号")]),t._v("\ns"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bind"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("host"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" port"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 设置最大连接数，超过后排队")]),t._v("\ns"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("listen"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 建立客户端连接")]),t._v("\nsock"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("addr "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" s"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("accept"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("      \n"),a("span",{attrs:{class:"token keyword"}},[t._v("print")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'Connection built!'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ninfo"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("while")]),t._v(" info"),a("span",{attrs:{class:"token operator"}},[t._v("!=")]),a("span",{attrs:{class:"token string"}},[t._v("'exit'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("print")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'Husband:'")]),a("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v("info"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    send_mes"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token builtin"}},[t._v("input")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    sock"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("send_mes"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encode"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'utf-8'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" send_mes"),a("span",{attrs:{class:"token operator"}},[t._v("==")]),a("span",{attrs:{class:"token string"}},[t._v("'exit'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("break")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    info"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("sock"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recv"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("1024")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("decode"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'utf-8'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsock"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("close"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ns"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("close"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("Client.py")])]),a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# 文件名：client.py")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 导入 socket模块")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" socket\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 创建 socket 对象")]),t._v("\ns "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" socket"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("socket"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 获取本地主机名")]),t._v("\nhost "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" socket"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gethostname"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 设置端口号")]),t._v("\nport "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("9999")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 连接服务，指定主机和端口")]),t._v("\ns"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connect"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("host"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" port"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("print")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'Likend!'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ninfo"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("while")]),t._v(" info"),a("span",{attrs:{class:"token operator"}},[t._v("!=")]),a("span",{attrs:{class:"token string"}},[t._v("'exit'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("print")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'Wife:'")]),a("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v("info"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    send_mes"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token builtin"}},[t._v("input")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     s"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("send_mes"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encode"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'utf-8'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" send_mes"),a("span",{attrs:{class:"token operator"}},[t._v("==")]),a("span",{attrs:{class:"token string"}},[t._v("'exit'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("break")]),t._v("\n   "),a("span",{attrs:{class:"token comment"}},[t._v("# 接收小于 1024 字节的数据")]),t._v("\n    info "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" s"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recv"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("1024")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("decode"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'utf-8'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ns"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("close"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("在终端先启动服务器，再启动客户端，便可以互相通信，目前只是实现了当服务器端输入'exit'，便断开连接。")])])])}],o=n(0),c=Object(o.a)({},function(){this.$createElement;this._self._c;return this._m(0)},a,!1,null,null,null);s.default=c.exports}}]);